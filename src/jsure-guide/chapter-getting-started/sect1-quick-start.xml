<?xml version="1.0" encoding="utf-8"?>

<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
"../../../lib/docbook-xml-4.5/docbookx.dtd">

<sect1 id="quick-start">
  <title>Quick start</title>

  <para>This section will quickly get you started with JSure. It
  describes how to install JSure into your Eclipse, how to install a
  license file that allows you to use JSure.  It also describes how to 
  enable JSure assurance of a Java project, and how to examine the
  assurance results.</para>

  <sect2>
    <title>Installing Your License</title>

    <para>This section assumes that you have installed JSure. If you
    see a <guimenu>JSure</guimenu> menu item on your Eclipse main menu
    then you can assume JSure has been installed properly.</para>

    <para>You need to install a license to use JSure.  If you do not
    have a license file that was sent to you by SureLogic visit <ulink
    url="http://www.surelogic.com">http://www.surelogic.com</ulink> to
    obtain one.  To install the license select <guimenuitem>Manage
    SureLogic Licenses</guimenuitem> from the <guimenu>JSure</guimenu>
    menu as shown in <xref linkend="fig-quick-start-license-menu"/>
    </para>

    <figure id="fig-quick-start-license-menu">
      <title>The menu option to install a license for JSure</title>
      <mediaobject>
        <imageobject>
          <imagedata fileref="images/quick-start-license-menu.png" />
        </imageobject>
      </mediaobject>
    </figure>

	  <para>This will cause the <guilabel>Manage SureLogic
	  Licenses</guilabel> window to appear as shown in <xref
	  linkend="fig-quick-start-license-dialog-empty" />.  Highlight the
	  JSure row and select the <guibutton>Install License</guibutton>
	  button to install your license file.</para>

    <figure id="fig-quick-start-license-dialog-empty">
      <title>The SureLogic license management dialog</title>
      <mediaobject>
        <imageobject>
          <imagedata fileref="images/quick-start-license-dialog-empty.png" />
        </imageobject>
      </mediaobject>
    </figure>

    <para>JSure will not disrupt your Eclipse installation if a
    license for it is not installed, however, it will not allow you to
    use JSure functionality.  We will assume from this point on that
    you have installed your license.  For more information, see <xref
    linkend="sec-license-management" /></para>
  </sect2>
  
  <sect2 id="sec-quick-start-annotations">
    <title>Annotating and Assuring Your Code</title>
    
    <para>For the impatient, this section provides a
    &ldquo;bare-bones&rdquo; description of how to prepare a Java
    project for assurance by JSure.</para>
    
    <para>JSure compares Java code with models of programmer design
    intent expressed using a set of Java 5 annotation types. The tool
    verifies model-code consistency. To use JSure with your code, your
    project must be able to reference the SureLogic annotation types
    declared in package <package>com.surelogic</package>.  The
    SureLogic annotation types are bundled together in
    <filename>promises-3.1.0.jar</filename>. This file must be on the
    build path of your project for the annotations be to used.  As
    described below, the simplest way to add this JAR file to the
    project and its build path is to allow JSure to do it for
    you.</para>

    <para>To manually add/update the JAR file select
    <menuchoice><guimenuitem>JSure</guimenuitem><guimenuitem>Add/Update
    Promises Library...</guimenuitem> from the Eclipse main menu as
    shown below.</menuchoice>

    <mediaobject>
      <imageobject>
	<imagedata fileref="images/quick-start-add-jar.png" />
      </imageobject>
    </mediaobject>

    This action will prompt you through the process of adding or
    updating the JAR to your project's classpath. It does not enable
    JSure on that project (as described below).</para>
    
    <sect3>
      <title>Enabling JSure Analysis</title>
      
      <para>JSure can only assure the contents of one project at a
      time. The icon of the project being assured is marked with a
      small <wordasword>S</wordasword> in the lower right corner:
      <guiicon><inlinegraphic
      fileref="images/jsure-nature.png"/></guiicon>. The
      <wordasword>J</wordasword> above the <wordasword>S</wordasword>
      are intended to remind you that this is the project JSure is
      analyzing. The easiest way to select the project to assure is to
      <orderedlist>
	<listitem><para>Select the project in the <guilabel>Package
	Explorer</guilabel>.</para></listitem>

	<listitem><para>Press the icon <guiicon><inlinegraphic
	fileref="images/jsure_verify.gif"/></guiicon> in the view&rsquo;s
	toolbar.  This same action is also available as
	<menuchoice><guimenuitem>Focus Verification on this
	Project</guimenuitem></menuchoice> in the view&rsquo;s menu.</para></listitem>
      </orderedlist>
      If any other project is currently selected for assurance, this action first
      disables assurance on that project before enabling the newly selected
      project.</para>
      
      <para>When a project is selected for analysis, JSure checks to
      see if <filename>promises-3.1.0.jar</filename> is on the
      project&rsquo;s build path.  If it is not, and your source code
      is for Java 5 or above, it offers to add the file to the project
      and the build path:
      
        <mediaobject>
          <imageobject>
            <imagedata fileref="images/add-promises-jar.png" />
          </imageobject>
        </mediaobject>

      The easiest thing to do is to choose the default option
      <guibutton>Add to Project Root</guibutton>: JSure copies
      <filename>promises-3.1.0.jar</filename> to the root of project and
      adds it to the build path. See <xref
      linkend="sec-adding-promises-jar"/> for more details.</para>
      
    </sect3>
    
    <sect3>
      <title>Disabling JSure Analysis</title>
      
      <para>To deselect a project without selecting another project to assure
        <orderedlist>
          <listitem><para>Select the project in the <guilabel>Package
          Explorer</guilabel>.</para></listitem>

          <listitem><para>Press the icon <guiicon><inlinegraphic
          fileref="images/jsure_no_verify.gif"/></guiicon> in the
          view&rsquo;s toolbar.  This same action is also available as
          <menuchoice><guimenuitem>Disable
          Verification</guimenuitem></menuchoice> in the view&rsquo;s
          menu.</para></listitem>
        </orderedlist>
      </para>
      
      <para>Disabling analysis of a project does not affect
      <filename>promises.jar</filename> or the project&rsquo;s build
      path, however, you can manually delete the Jar and remove it
      from the build path if you haven&rsquo;t added any
      annotations to your code.</para>
    </sect3>
        
    <sect3>
      <title>Viewing Assurance Results</title>
      
      <para>JSure reassures the chosen project whenever a file in that project
      is changed.  This guarantees that the assurance results are always up to
      date.  The assurance results are displayed in the <guilabel>Verification
      Status</guilabel> view.  The easiest way to open this view is to switch
      to the <guilabel>Code Verification</guilabel> perspective.  The first time you enable
      JSure analysis on any project in the workspace JSure prompts you
      about switching to the <guilabel>Code Verification</guilabel>
      perspective:
      
        <mediaobject>
          <imageobject>
            <imagedata fileref="images/perspective-switch.png" />
          </imageobject>
        </mediaobject>

      Choosing <guibutton>Yes</guibutton> will immediately switch Eclipse to 
      the perspective.  Choosing <guibutton>No</guibutton> will leave
      the current Eclipse window in whatever perspective it is currently in.  If you check
      <guibutton>Remember my decision</guibutton> and press <guibutton>Yes</guibutton>
      then whenever you focus verification on a project, Eclipse will switch
      to the perspective without asking you first.</para>

      <para>You can also switch to the <guilabel>Code Verification</guilabel>
      perspective by selecting <menuchoice><guimenu>JSure</guimenu>
      <guimenuitem>Open Code Verification Perspective</guimenuitem></menuchoice>.  
      See <xref linkend="fig-open-code-verification"/>.</para>
      
      <figure id="fig-open-code-verification">
        <title>Opening the Code Verification Perspective</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="images/open-code-verification.png" />
          </imageobject>
        </mediaobject>
      </figure>

      <para>The code verification perspective defaults to showing the
      <guilabel>Package Explorer</guilabel> and <guilabel>Verification
      Status</guilabel> views; see <xref
      linkend="fig-code-verification-perspective"/>.</para>

      <figure id="fig-code-verification-perspective">
        <title>The Code Verification Perspective</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="images/code-verification-perspective.png" />
          </imageobject>
        </mediaobject>
      </figure>

      <para>The <guilabel>Verification Status</guilabel> view is
      divided into sections to show the results of assuring different
      classes of design intent, such as effects, and concurrency, as
      well as showing less specific suggestions and warnings. The
      various result messages are explained in detail in <xref
      linkend="understanding-assurance-output"/>. <xref
      linkend="fig-code-verification-perspective"/> also shows the
      <guilabel>Modeling Problems</guilabel> view which, by default,
      will not appear. This view will appear below the
      <guilabel>Verification Status</guilabel> view if any of the
      annotations in your code do not make sense to JSure. This view
      lists each bad annotation so that the programmer can fix
      them.</para>

      <para>The icons shown in the <guilabel>Verification
      Status</guilabel> view have meaning. The table below is a quick
      reference about what each icon and decorator indicates to the
      tool user.</para>

      <informaltable frame='none'>
	<tgroup cols='2' align='left'>
	<colspec colwidth='1in' align='center'/>
	  <thead>
	    <row>
	      <entry>Image</entry>
	      <entry>Semantics</entry>
	    </row>
	  </thead>
	  <tbody>
	    <row>
	      <entry><inlinegraphic fileref="images/annotation.gif"/></entry>
	      <entry>An annotation or promise about the code</entry>
	    </row>
	    <row>
	      <entry><inlinegraphic fileref="images/plus.gif"/></entry>
	      <entry>Consistent analysis result</entry>
	    </row>
	    <row>
	      <entry><inlinegraphic fileref="images/red_x.gif"/></entry>
	      <entry>Inconsistent analysis result</entry>
	    </row>
	    <row>
	      <entry><inlinegraphic fileref="images/plus_vouch.gif"/></entry>
	      <entry>Inconsistent analysis result vouched for by the programmer using @Vouch</entry>
	    </row>
	    <row>
	      <entry><inlinegraphic fileref="images/consistent_decr.gif"/></entry>
	      <entry>Consistent verification result decorator</entry>
	    </row>
	    <row>
	      <entry><inlinegraphic fileref="images/inconsistent_decr.gif"/></entry>
	      <entry>Inconsistent verification result decorator</entry>
	    </row>
	    <row>
	      <entry><inlinegraphic fileref="images/trusted_decr.gif"/></entry>
	      <entry>Trusted promise decorator &ndash; the annotation is not checked by analysis</entry>
	    </row>
	    <row>
	      <entry><inlinegraphic fileref="images/reddot_decr.gif"/></entry>
	      <entry>Red dot &ndash; an @Vouch or trusted promise is used in the verification proof</entry>
	    </row>
	    <row>
	      <entry><inlinegraphic fileref="images/virtual_decr.gif"/></entry>
	      <entry>Virtual promise decorator &ndash; created by @Promise</entry>
	    </row>
	    <row>
	      <entry><inlinegraphic fileref="images/info.gif"/></entry>
	      <entry>Informational message &ndash; a possible next modeling step</entry>
	    </row>
	    <row>
	      <entry><inlinegraphic fileref="images/warning.gif"/></entry>
	      <entry>Warning message &ndash; a possible next modeling step</entry>
	    </row>
	    <row>
	      <entry><inlinegraphic fileref="images/annotation_error.gif"/></entry>
	      <entry>Modeling problem &ndash; check the syntax of your annotations</entry>
	    </row>
	  </tbody>
	</tgroup>
      </informaltable>
    </sect3>
  </sect2> 
</sect1>
